/*! cond-query 17-01-2015 */
!function(a,b){"use strict";var c="bool",d="fkt",e="and",f="and-not",g=1,h=2,i=3,j=function(){this._current=-1,this.reset()},k=function(a,b){switch(b.type){case c:return a===e?b.value:!b.value;case d:return a===e?b.value():!b.value()}throw new Error("Unknown type or undefined property found")},l=function(a,b){var c=this;return function(d){var e=h;for(var f in a.conditions)if(a.conditions.hasOwnProperty(f)){var g=a.conditions[f];k(g,c._props[f])||(e=i)}a.resetter&&c._running[b]===h&&e===i&&a.resetter.apply(this,[d]),c._running[b]=e,e===h&&a.call.fkt.apply(this,[d,a.call.params])}},m=function(a,c,d,e){if("number"!=typeof a)throw new Error("Invalid parameter start");if("number"!=typeof c)throw new Error("Invalid parameter start");for(var f=a;c>f;f++){var g=d._events[f],h=b(g.event.el),i=g.event.ev;e.call(d,g,f,h,i)}};j.prototype.addProperty=function(a,b){if(this._props[a])throw new Error('Trying to register "'+a+'" twice');var e={value:b};switch((typeof b).toLowerCase()){case"function":e.type=d;break;case"boolean":e.type=c;break;default:throw new Error("Unknown typeof property. Please use either a function or a beoolean.")}return this._props[a]=e,this},j.prototype.addProperties=function(a){for(var b in a)propertys.hasOwnProperty(b)&&this.addProperty(b,a[b]);return this},j.prototype.on=function(a,b){if(!b)throw new Error("Missing required param eventName");if(!a)throw new Error("Missing required param element");return this._current++,this._events[this._current]={event:{el:a,ev:b},conditions:[],call:{fkt:null,params:[]},resetter:null},this._running[this._current]=g,this},j.prototype.when=function(a){if(!this._props[a])throw new Error('Unknown property "'+a+'".');return this._events[this._current].conditions[a]=e,this},j.prototype.and=j.prototype.when,j.prototype.whenNot=function(a){if(!this._props[a])throw new Error('Unknown property "'+a+'".');return this._events[this._current].conditions[a]=f,this},j.prototype.andNot=j.prototype.whenNot,j.prototype.invoke=function(a){if("function"!=typeof a)throw new Error("Only functions can be called.");return this._events[this._current].call.fkt=a,this},j.prototype["with"]=function(a){return this._events[this._current].call.params.push(a),this},j.prototype.andWith=j.prototype["with"],j.prototype.resetWith=function(a){if("function"!=typeof a)throw new Error("Only functions can be resetters");return this._events[this._current].resetter=a,this},j.prototype.start=function(a){var c={};if(m(this._startedFrom,this._current+1,this,function(b,d,e,f){var g=l.call(this,b,d);if(b._handler=g,e.on(f,g),a)for(var h=0;h<e.length;h++){e[h].id||(e[h].id="condQuery"+(new Date).getTime());var i="#"+e[h].id;c[i]||(c[i]={}),c[i][f]=e}}),this._startedFrom=this._current,!a)return this;for(var d in c)for(var e in c[d])b(c[d][e]).trigger(e);return this},j.prototype.reset=function(){return m(0,this._current+1,this,function(a,b,c,d){a._handler&&c.off(d,a._handler)}),this._props={},this._events=[],this._current=-1,this._running=[],this._startedFrom=0,this},a.condQuery=new j}(window,jQuery);